---
layout: case
title: SolarMan backend administrator account/password
excerpt: "Please set this to and except of a few lines.
Excerpts are shown on /cases"
author: Frank Breedijk
lead: Frank Breedijk
researchers:
- Jelle Ursem
- Célistine Oosting
cves:
- n/a
product: 
- SolarMan converters/loggers/batteries
- Solis converters/loggers/batteries
- Omnik converters/loggers/batteries
- Ginlong converters/loggers/batteries
versions: 
- Not researched
recommendation: Consider the risks when using these products
patch_status: n/a
workaround: n/a
status : Closed
start: 2022-02-06
end: 2022-07-02
timeline:
- start: 2019-08-05
  event: "Password(s) committed to GitHub repository"
- start: 2019-08-05
  end:   2021-04-24
  event: Password exposed and service vulnerable - 1st time
- start: 2021-04-16
  event: "Célistine Oosting, tweets that Omnik coverter is now uploading data to China (https://twitter.com/TheRealProcyon/status/1383154764213538816)"
- start: 2021-04-17
  event: "Jelle finds working password for SolarMan Super ADmin account in Github prepo (https://twitter.com/SchizoDuckie/status/1383365466702237703)"
- start: 2021-04-17
  event: "Vendor informed"
- start: 2021-04-24
  event: "Password changed"
- start: 2022-02-03
  event: "Jelle discovers that password was changed back to password in GitHub repo"
- start: 2022-02-03
  end:   2022-07-02
  event: Password exposed and service vulnerable - 1st time
- start: 2022-02-06
  event: "Case opened"
- start: 2022-02-06
  event: Vendor notified
- start: 2022-02-07
  event: DIVD involves the Dutch National Cyber Security Center (NCSC)
- start: 2022-02-20
  event: NCSC notifies vendor and Cert.cn
- start: 2022-05-10
  event: NCSC involves the Dutch ambassy in China.  
- start: 2022-06-09
  event: NCSC and China Cert in contact. Case has been given to China Cert
- start: 2022-06-17
  event: DIVD contacts our office neighbour, the Chineese consulate in The Hague. We are given an (unnamed) liason at China Cert
- start: 2022-07-02
  end:   
  event: "Account is closed and GitHub repo removed"
- start: 2022-07-02
  event: Case closed
- start: 2022-07-03
  end:   
  event: "NCSC reports that the Dutch ambassador has sent a formal letter to China Cert who confirmed receipt of the data"
ips: 0 
# You can set IPs to n/a when this case isn't about IPs (e.g. stolen credentials)
#
# The lines below redirect all the CVE references to our site
#jekyll-secinfo:
#  cve:
#    url: /cves/CVE-
---
## Summary

Triggered by a [tweet from  Célistine Oosting](https://twitter.com/TheRealProcyon/status/1383154764213538816), Jelle Ursem decides to look for SolarMan credits and [finds](https://twitter.com/SchizoDuckie/status/1383365466702237703) a (now removed) [GitHub repository](https://github.com/liyanyanwsy/wsy/blob/a067a21f26c5b1a9eff7c01ff02f5df3b58ae516/app/sunny/total/total.py) containing a username and password. 

![Screenshot of the repo and the passwords (blurred)](/img/DIVD-2022-00009/password.png)

Turns out this is indeed the Super Admin account and working password. Sincde the account doesn't have MFA Jelle was able to log in with the username and password.

![Screenshot of Super Admin access](/img/DIVD-2022-00009/access.png)

This backend and the Super Admnistrator account gives the ability to:
* See all data from all customers including:
  - GPS coordinates
  - Current and historical production data
  - Current faults
* Clearing of faults
* Downloading firmware
* Uploading of firmware to devices
* Creation and deletion of customers

In the SolarMan platform there are over 1,000,000 plants (installations) with a total power over over 10GwP (actually generated). Most systems are located in China and Australia, but a significant number of 40k+ in The Netherlands.

In the second half of April 2021 SolarMan gets notified and changes the password. On 3 Feb 2022, Jelle reads [Jan van Kampen's blogpost on Growatt](https://janvankampen.nl/?p=516) and decides to check the password again. To his horror the password has been changed back to the password in the GitHub repo.

On 4 Feb Jelle joins DIVD and on 6 feb we opened this case.

Getting the account closed turns out to be hard. The first time the vendor responded promptly, but silently. In fact neither we nor the NSCS even got any reply from them. NCSC used the diplomatic channels via the Dutch embassy and head of research Victor Gevers, visited the Chineese embassy in The Hague, all to escalate this issue. In the end the password has been changed and the repository deleted.

The netto effect of deleting the repository and resetting the password, is that the number of parties that the ability to abuse this access has been reduced from "everybody that was able to find the password" to the vendor and whomever can control the vendor.

## What you can do

Not much. End users do not have any control over these event.

However, when installing smart devices please consider that:
* You data is often uploaded to the vendor
* The vendor may change
* The vendor has ultimate control over the device
* When the vendor gets compromised, you device can be compromised as well

## What we are doing

Case has been closed, no further action. 

We will be presenting the details of this case [at the MCH 2022, hack camp](https://program.mch2022.org/)

{% comment %}  Leave this here, so we see a timeline{% endcomment %}
{% include timeline.html %}


## More information
* [Tweet that triggered the investigation](https://twitter.com/TheRealProcyon/status/1383154764213538816) by Célistine Oosting
* [Tweet in which Jelle makes his find public for the first time](https://twitter.com/SchizoDuckie/status/1383365466702237703)
* [Now deleted GitHub repository](https://github.com/liyanyanwsy/wsy/blob/a067a21f26c5b1a9eff7c01ff02f5df3b58ae516/app/sunny/total/total.py)
* [Jan van Kampen's blogpost on Growatt](https://janvankampen.nl/?p=516)
* [New article about Dutch government blocking a Chineese party from the Dutch grid](https://www.nu.nl/klimaat/6208030/ministerie-greep-in-om-chinees-bedrijf-uit-nederlands-stroomnet-te-houden.html)