---
layout: case
title: Critical vulnerabilities in ITarian MSP platform and on-premise solution
excerpt: "ITarian a online platform and on-premise solution for Managed Services Providers, contains 3 critical vulnerabilities"
author: 
- Vitor Pasman
- Frank Breedijk
lead: Victor Gevers
researchers:
- Wietse Boonstra
- Hidde Smit
- Victor Gevers
- Victor Pasman
- Frank Breedijk
cves:
- CVE-2022-25151
- CVE-2022-25152
- CVE-2022-25153
product: 
- ITarian All-in-one SaaS for MSPs
- ITarian On Premise
- ITarian Endpoint Manager Communication Client
#versions: 
#- All versions
#- Again one per line
recommendation: Given the nature of the vulnerabilities we discovered and the lack of response from the vendor we recommend all users to stop using this product
patch_status: Not patched
#workaround: n/a
status : Open
start: 2021-12-01
end: 
timeline:
- start: 2021-12-01
  end:
  event: "Three vulnerabilities discovered"
- start: 2021-12-01
  end:
  event: "Additional vulnerability discovered"
- start: 2022-01-06
  end:
  event: "Vulnerabilities reported to Brad Miller, the ITarian CEO via email. But, the email bounced"
- start: 2022-01-06
  end:
  event: "Vulnerabilities reported to ITarian support via email"
- start: 2022-01-11
  end:
  event: "Contacted Dr. Erdal Ozkaya, the ITarian CISO via LinkedIn"
- start: 2022-01-12
  end:
  event: "Details of the vulnerabilities reported to ITarian CISO via email"
- start: 2022-01-12
  end:   2022-01-19  
  event: "Time to acknowledge receipt"
- start: 2022-01-19
  end:
  event: "CISO confirms receipt of the details and states that he 'will verify this with my engineering team and let you know'"
- start: 2022-02-14
  end:
  event: "Released a TLP-Amber warning to Trusted Information Sharing Partners"
- start: 2022-01-12
  end:   open
  event: "Time to acknowledge vulnerability"
  # Time to acknowledge is an important metric we like to track it
- start: 2022-01-12
  end:   open
  event: "Time to patch"
  # Time to patch is another important metric
- start: 2022-01-12
  end:   2022-05-01
  event: "Time to (limited) public disclosure"
- start: 2022-05-01
  end:   
  event: "DIVD publicly releases limited information about the vulnerabilities"
- start: 2022-01-12
  end:   2022-05-31
  event: "Time to full public disclosure"
- start: 2022-05-31
  end:   
  event: "Deadline for full disclosure"
ips: 0 
# You can set IPs to n/a when this case isn't about IPs (e.g. stolen credentials)
#
# The lines below redirect all the CVE references to our site
jekyll-secinfo:
  cve:
    url: /cves/CVE-
---
## Summary

DIVD researchers have identified multiple vulnerabilities in ITarian products. The vulnerabilities have been found in the following products:
* ITarian SaaS platform
* ITarian on-premise (version 6.35.37347.20040)
* Endpoint Manager Communication Client (version 6.43.41148.21120)

ITarian on-premise platform is vulnerable to:
* {% cve CVE-2022-25151 %}, Session cookie not protected by HttpOnly flag (ITarian SaaS platform / on-premise)
* {% cve CVE-2022-25152 %}, Creation of procedure and bypass approval (ITarian SaaS platform / on-premise)

Endpoint Manager Communication Client is vulnerable to:
* {% cve CVE-2022-25153 %}, Endpoint Manager agent local privilege escalation

The Saas Platform has two additional vulnerabilities:
* A XSS in the helpdesk function
* The ability to brute force the download URL of the agent packages for other tenants

Despite several attempts, via various routes, we have not received any significant feedback from ITarian and we have therefore decided to publicly disclose limited details of our findings.

By chaining the XSS in the helpdesk product with CVE-2022-25152 an attacker would theoretically be able to create a service desk ticket that, when viewed by a user with a valid session token, will execute a workflow on all clients with superuser privileges.

With this disclosure, we want to warn ITarian customers that they are using an insecure product that can be weaponized for malicious purposes, e.g. in a Kaseya VSA-like scenario to deliver malware into their infrastructure.

## What you can do

To our knowledge, there are currently no patches available for the vulnerabilities in both the ITarian SaaS Platform and the ITarian on-premise version nor for the vulnerabilities in the Manager Communication Client. 

For users of ITarian on-premise version, we strongly advise to not expose these systems to the internet.


For users of the ITarian SaaS platform, users cannot take any action to remediate the vulnerability on their own, and the only possible solution available is to stop using the platform.

All users of ITarian products should be aware of the privilege escalation on Endpoint Manager Communications Client on Windows. This agent is installed by default on all Windows systems managed via either the Saas or on-premise version of ITarian and allows an attacker with low privilege system access to escalate privileges to SYSTEM. We advise users to deinstall this agent on systems that are also used interactively by low-privileged users.

Additionally, we ask all ITarian users to reach out to ITarian to demand that these vulnerabilities are patched as soon as possible, as all our attempts to contact ITarian so far have yielded zero results.

## What we are doing

Fixing these vulnerabilities is clearly the responsibility of ITarian. We have no reliable way to fingerprint on-premise installation and no way to identify the users of the SaaS platform.

Limited disclosure of these vulnerabilities, 109 days after successfully informing the vendor, is our pan-ultimate attempt to get these issues fixed before they are exploited. A full disclosure, currently planned for 31 May 2022 (30 days after limited disclosure and 139 days after we made ITarian aware of these issues), will be the next step in this process.

{% include timeline.html %}